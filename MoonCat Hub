-- Ki·ªÉm tra t·∫£i Orion UI
local success, OrionLib = pcall(function()
    return loadstring(game:HttpGet("https://raw.githubusercontent.com/shlexware/Orion/main/source"))()
end)

-- Bi·∫øn ƒë·ªÉ ki·ªÉm tra xem Orion UI c√≥ ho·∫°t ƒë·ªông kh√¥ng
local orionLoaded = success

-- N·∫øu Orion UI kh√¥ng t·∫£i ƒë∆∞·ª£c, th√¥ng b√°o v√† chuy·ªÉn sang ch·∫ø ƒë·ªô kh√¥ng UI
if not orionLoaded then
    warn("Kh√¥ng th·ªÉ t·∫£i Orion UI: " .. OrionLib)
    print("Chuy·ªÉn sang ch·∫ø ƒë·ªô kh√¥ng UI. Nh·∫≠p l·ªánh v√†o chat ƒë·ªÉ s·ª≠ d·ª•ng:")
    print("- 'farm on' ƒë·ªÉ b·∫≠t Auto Farm")
    print("- 'farm off' ƒë·ªÉ t·∫Øt Auto Farm")
    print("- 'teleport <ƒë·∫£o>' ƒë·ªÉ d·ªãch chuy·ªÉn (VD: teleport Starter Pirate Island)")
    print("- 'esp on' ƒë·ªÉ b·∫≠t ESP")
    print("- 'esp off' ƒë·ªÉ t·∫Øt ESP")
end

-- Kh·ªüi t·∫°o c√°c d·ªãch v·ª•
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local Workspace = game:GetService("Workspace")
local UserInputService = game:GetService("UserInputService")
local Lighting = game:GetService("Lighting")

-- Bi·∫øn tr·∫°ng th√°i
local toggles = {
    AutoFarmLevel = false,
    Teleport = false,
    ESP = false,
    DarkMode = true,
}
local attackSpeed = 0.5
local espInstances = {}

-- H√†m d·ªãch chuy·ªÉn
local function teleportTo(pos)
    if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
        LocalPlayer.Character.HumanoidRootPart.CFrame = pos
    end
end

-- H√†m d·ªçn d·∫πp ESP
local function clearESP()
    for _, esp in pairs(espInstances) do
        if esp then
            esp:Destroy()
        end
    end
    espInstances = {}
end

-- H√†m Auto Farm
local function autoFarm(state)
    toggles.AutoFarmLevel = state
    if state then
        spawn(function()
            while toggles.AutoFarmLevel and LocalPlayer.Character do
                if next(Workspace.Enemies:GetChildren()) then
                    for _, enemy in pairs(Workspace.Enemies:GetChildren()) do
                        if enemy:FindFirstChild("Humanoid") and enemy.Humanoid.Health > 0 then
                            teleportTo(enemy.HumanoidRootPart.CFrame * CFrame.new(0, 5, 0))
                            wait(attackSpeed)
                        end
                    end
                else
                    if orionLoaded then
                        OrionLib:MakeNotification({
                            Name = "MoonCat Hub",
                            Content = "Kh√¥ng t√¨m th·∫•y qu√°i!",
                            Time = 3
                        })
                    else
                        print("Kh√¥ng t√¨m th·∫•y qu√°i!")
                    end
                    wait(2)
                end
                wait(1)
            end
        end)
    end
end

-- H√†m Teleport
local function teleportToIsland(island)
    local locations = {
        -- First Sea
        ["Starter Pirate Island"] = CFrame.new(1050, 17, 1350),
        ["Starter Marine Island"] = CFrame.new(-500, 17, 1500),
        ["Jungle"] = CFrame.new(1500, 17, -1500),
        ["Pirate Village"] = CFrame.new(100, 17, -5000),
        ["Desert"] = CFrame.new(1000, 17, 4500),
        ["Middle Island"] = CFrame.new(0, 17, 0),
        ["Frozen Village"] = CFrame.new(1200, 17, -1100),
        ["Marine Fortress"] = CFrame.new(-5000, 17, 5000),
        ["Skylands"] = CFrame.new(150, 500, 150),
        ["Prison"] = CFrame.new(5000, 17, 1000),
        ["Colosseum"] = CFrame.new(-1500, 17, 3000),
        ["Magma Village"] = CFrame.new(-5000, 17, -2000),
        ["Underwater City"] = CFrame.new(4000, -200, 4000),
        ["Fountain City"] = CFrame.new(5000, 17, -5000),

        -- Second Sea
        ["Kingdom of Rose"] = CFrame.new(-2000, 17, -2000),
        ["Usoap‚Äôs Island"] = CFrame.new(-3000, 17, 1000),
        ["Graveyard Island"] = CFrame.new(500, 17, 3000),
        ["Dark Arena"] = CFrame.new(5000, 17, 5000),
        ["Snow Mountain"] = CFrame.new(1000, 500, -3000),
        ["Hot and Cold"] = CFrame.new(-5000, 17, 3000),
        ["Cursed Ship"] = CFrame.new(0, 500, 5000),
        ["Ice Castle"] = CFrame.new(5000, 17, -3000),
        ["Forgotten Island"] = CFrame.new(-3000, 17, -5000),

        -- Third Sea
        ["Port Town"] = CFrame.new(-300, 17, -1000),
        ["Hydra Island"] = CFrame.new(5750, 610, -280),
        ["Great Tree"] = CFrame.new(2000, 17, -5000),
        ["Floating Turtle"] = CFrame.new(-12550, 332, -7870),
        ["Castle on the Sea"] = CFrame.new(-5000, 17, 1000),
        ["Haunted Castle"] = CFrame.new(-9500, 17, 5000),
        ["Sea of Treats"] = CFrame.new(0, 17, -10000),
        ["Tiki Outpost"] = CFrame.new(-16250, 100, 1000),

        -- Special Locations
        ["Heaven Dimension"] = CFrame.new(0, 1000, 0),
        ["Hell Dimension"] = CFrame.new(0, -1000, 0),
        ["Frozen Dimension"] = CFrame.new(5000, 17, 5000),
        ["Treasure Island"] = CFrame.new(-10000, 17, -5000),
        ["Mirage Island"] = CFrame.new(0, 100, 0)
    }
    if locations[island] then
        teleportTo(locations[island])
        if orionLoaded then
            OrionLib:MakeNotification({
                Name = "MoonCat Hub",
                Content = "ƒê√£ d·ªãch chuy·ªÉn ƒë·∫øn " .. island,
                Time = 3
            })
        else
            print("ƒê√£ d·ªãch chuy·ªÉn ƒë·∫øn " .. island)
        end
    else
        if orionLoaded then
            OrionLib:MakeNotification({
                Name = "MoonCat Hub",
                Content = "ƒê·∫£o kh√¥ng h·ª£p l·ªá! Ki·ªÉm tra danh s√°ch ƒë·∫£o trong Teleport tab.",
                Time = 3
            })
        else
            print("ƒê·∫£o kh√¥ng h·ª£p l·ªá! C√°c ƒë·∫£o: " .. table.concat({unpack(locations)}, ", "))
        end
    end
end

-- H√†m ESP
local function toggleESP(state)
    toggles.ESP = state
    if state then
        spawn(function()
            while toggles.ESP and LocalPlayer.Character do
                for _, obj in pairs(Workspace:GetChildren()) do
                    if obj:FindFirstChild("Humanoid") and not obj:FindFirstChild("BillboardGui") then
                        local esp = Instance.new("BillboardGui", obj)
                        esp.Size = UDim2.new(0, 100, 0, 50)
                        esp.StudsOffset = Vector3.new(0, 3, 0)
                        local text = Instance.new("TextLabel", esp)
                        text.Size = UDim2.new(1, 0, 1, 0)
                        text.Text = obj.Name
                        text.BackgroundTransparency = 1
                        text.TextColor3 = Color3.fromRGB(255, 0, 0)
                        table.insert(espInstances, esp)
                    end
                end
                wait(5)
            end
        end)
    else
        clearESP()
        if orionLoaded then
            OrionLib:MakeNotification({
                Name = "MoonCat Hub",
                Content = "ESP ƒë√£ t·∫Øt!",
                Time = 3
            })
        else
            print("ESP ƒë√£ t·∫Øt!")
        end
    end
end

-- N·∫øu Orion UI t·∫£i th√†nh c√¥ng, t·∫°o giao di·ªán
if orionLoaded then
    local Window = OrionLib:MakeWindow({
        Name = "üåô MoonCat Hub - Blox Fruits",
        HidePremium = false,
        SaveConfig = true,
        ConfigFolder = "MoonCatHub",
        IntroText = "MoonCat Hub",
        IntroIcon = "rbxassetid://6026568198", -- Icon m·∫∑t trƒÉng
        IntroEnabled = true
    })

    -- Tab Auto Farm
    local FarmTab = Window:MakeTab({
        Name = "Farm",
        Icon = "rbxassetid://4483345998", -- Icon ki·∫øm
        PremiumOnly = false
    })
    FarmTab:AddToggle({
        Name = "Auto Farm Level",
        Default = false,
        Callback = function(state)
            autoFarm(state)
            OrionLib:MakeNotification({
                Name = "MoonCat Hub",
                Content = "Auto Farm " .. (state and "b·∫≠t" or "t·∫Øt") .. "!",
                Time = 3
            })
        end
    })

    -- Tab Teleport
    local TeleportTab = Window:MakeTab({
        Name = "Teleport",
        Icon = "rbxassetid://6022668885", -- Icon d·ªãch chuy·ªÉn
        PremiumOnly = false
    })
    TeleportTab:AddDropdown({
        Name = "Teleport to Island",
        Default = "Starter Pirate Island",
        Options = {
            -- First Sea
            "Starter Pirate Island", "Starter Marine Island", "Jungle", "Pirate Village", "Desert",
            "Middle Island", "Frozen Village", "Marine Fortress", "Skylands", "Prison",
            "Colosseum", "Magma Village", "Underwater City", "Fountain City",
            -- Second Sea
            "Kingdom of Rose", "Usoap‚Äôs Island", "Graveyard Island", "Dark Arena", "Snow Mountain",
            "Hot and Cold", "Cursed Ship", "Ice Castle", "Forgotten Island",
            -- Third Sea
            "Port Town", "Hydra Island", "Great Tree", "Floating Turtle", "Castle on the Sea",
            "Haunted Castle", "Sea of Treats", "Tiki Outpost",
            -- Special Locations
            "Heaven Dimension", "Hell Dimension", "Frozen Dimension", "Treasure Island", "Mirage Island"
        },
        Callback = function(selected)
            teleportToIsland(selected)
        end
    })

    -- Tab ESP
    local ESPTab = Window:MakeTab({
        Name = "ESP",
        Icon = "rbxassetid://6023426921", -- Icon m·∫Øt
        PremiumOnly = false
    })
    ESPTab:AddToggle({
        Name = "ESP",
        Default = false,
        Callback = function(state)
            toggleESP(state)
            OrionLib:MakeNotification({
                Name = "MoonCat Hub",
                Content = "ESP " .. (state and "b·∫≠t" or "t·∫Øt") .. "!",
                Time = 3
            })
        end
    })

    -- Tab Settings
    local SettingsTab = Window:MakeTab({
        Name = "Settings",
        Icon = "rbxassetid://6023426915", -- Icon c√†i ƒë·∫∑t
        PremiumOnly = false
    })
    SettingsTab:AddToggle({
        Name = "Dark/Light Mode",
        Default = true,
        Callback = function(state)
            toggles.DarkMode = state
            OrionLib:MakeNotification({
                Name = "MoonCat Hub",
                Content = state and "üåô Dark Mode" or "‚òÄÔ∏è Light Mode",
                Time = 3
            })
        end
    })
    SettingsTab:AddButton({
        Name = "Remove Fog",
        Callback = function()
            Lighting.FogEnd = 100000
            Lighting.FogStart = 100000
            if Lighting:FindFirstChild("Atmosphere") then
                Lighting.Atmosphere:Destroy()
            end
            OrionLib:MakeNotification({
                Name = "MoonCat Hub",
                Content = "ƒê√£ x√≥a s∆∞∆°ng m√π!",
                Time = 3
            })
        end
    })

    -- Th√¥ng b√°o kh·ªüi ƒë·ªông
    OrionLib:MakeNotification({
        Name = "MoonCat Hub",
        Content = "MoonCat Hub (Orion Edition) ƒë√£ ch·∫°y!",
        Time = 5
    })

    -- T√πy ch·ªânh giao di·ªán trong su·ªët
    local ui = game:GetService("CoreGui"):FindFirstChild("Orion")
    if ui then
        for _, v in pairs(ui:GetDescendants()) do
            if v:IsA("Frame") then
                v.BackgroundTransparency = 0.7 -- ƒê·ªô trong su·ªët (0: kh√¥ng trong su·ªët, 1: ho√†n to√†n trong su·ªët)
                v.BackgroundColor3 = Color3.fromRGB(30, 30, 30) -- M√†u n·ªÅn t·ªëi
                v.BorderColor3 = Color3.fromRGB(255, 105, 180) -- Vi·ªÅn m√†u h·ªìng ph·∫•n
                v.BorderSizePixel = 1
            elseif v:IsA("TextLabel") or v:IsA("TextButton") then
                v.TextColor3 = Color3.fromRGB(255, 215, 0) -- Ch·ªØ m√†u v√†ng s√°ng
                v.BackgroundTransparency = 0.8
            elseif v:IsA("TextButton") and v.Name == "TabButton" then
                v.BackgroundColor3 = Color3.fromRGB(75, 0, 130) -- M√†u tab t√≠m ƒë·∫≠m
                v.BackgroundTransparency = 0.6
            end
        end
    end
end

-- X·ª≠ l√Ω l·ªánh qua chat (d·ª± ph√≤ng n·∫øu UI kh√¥ng hi·ªÉn th·ªã)
UserInputService.InputBegan:Connect(function(input)
    if input.KeyCode == Enum.KeyCode.Semicolon then
        local command = LocalPlayer.PlayerGui:WaitForChild("Chat"):WaitForChild("Frame"):WaitForChild("ChatBar").Text
        local args = command:split(" ")
        if args[1] == "farm" then
            if args[2] == "on" then
                autoFarm(true)
                if orionLoaded then
                    OrionLib:MakeNotification({
                        Name = "MoonCat Hub",
                        Content = "Auto Farm ƒë√£ b·∫≠t!",
                        Time = 3
                    })
                else
                    print("Auto Farm ƒë√£ b·∫≠t!")
                end
            elseif args[2] == "off" then
                autoFarm(false)
                if orionLoaded then
                    OrionLib:MakeNotification({
                        Name = "MoonCat Hub",
                        Content = "Auto Farm ƒë√£ t·∫Øt!",
                        Time = 3
                    })
                else
                    print("Auto Farm ƒë√£ t·∫Øt!")
                end
            end
        elseif args[1] == "teleport" then
            local island = table.concat({unpack(args, 2)}, " ")
            teleportToIsland(island)
        elseif args[1] == "esp" then
            if args[2] == "on" then
                toggleESP(true)
                if orionLoaded then
                    OrionLib:MakeNotification({
                        Name = "MoonCat Hub",
                        Content = "ESP ƒë√£ b·∫≠t!",
                        Time = 3
                    })
                else
                    print("ESP ƒë√£ b·∫≠t!")
                end
            elseif args[2] == "off" then
                toggleESP(false)
            end
        end
    end
end)

-- Th√¥ng b√°o kh·ªüi ƒë·ªông trong console n·∫øu kh√¥ng c√≥ UI
if not orionLoaded then
    print("MoonCat Hub (No UI Version) ƒë√£ ch·∫°y!")
end
